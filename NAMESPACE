import(grDevices)
import(graphics)
import(methods)
import(stats)
importFrom(utils, read.table)

import(Biobase)
import(gdsfmt)
import(graph)
import(Matrix)
import(data.table)

importFrom(GWASTools,
           GdsGenotypeReader,
           GenotypeData,
           GenotypeBlockIterator)
importClassesFrom(GWASTools,
                  GdsGenotypeReader,
                  GenotypeData,
                  GenotypeIterator,
                  GenotypeBlockIterator,
                  ScanAnnotationDataFrame)
importMethodsFrom(GWASTools,
                  close,
                  getChromosome,
                  getGenotypeSelection,
                  getPosition,
                  getScanAnnotation,
                  getScanID,
                  getSnpID,
                  getVariable,
                  getSex,
                  hasSex,
                  snpFilter,
                  XchromCode,
                  YchromCode)

import(SeqArray)
import(SeqVarTools)

importFrom(SNPRelate,
           snpgdsPCA,
           snpgdsPCASNPLoading,
           snpgdsPCASampLoading)

importFrom(BiocGenerics, start, end)
importFrom(GenomicRanges, GRanges)
importFrom(IRanges, IRanges, findOverlaps)
importFrom(S4Vectors, mcols, queryHits, subjectHits)

importFrom(dplyr, bind_rows, inner_join)

export(kingToMatrix,
       king2mat,
       kin2gds,
       mat2gds,
       pcairPartition,
       pcrelate,
       pcrelateMakeGRM,
       pcrelateReadInbreed,
       pcrelateReadKinship)

export(admixMapMM,
       assocTestMM,
       assocTestSeq,
       assocTestSeqWindow,
       fitNullMM,
       fitNullReg,
       varCompCI)

exportMethods(assocTestSingle,
              assocTestAggregate,
              fitNullModel,
              pcair)
export(admixMap,
       nullModelInvNorm)

S3method(plot, pcair)
S3method(summary, pcair)
S3method(print, pcair)
S3method(print, summary.pcair)
